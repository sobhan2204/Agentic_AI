<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Agent - Enterprise Multi-Server Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0a0e1a;
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #1a1d29 0%, #2d3748 100%);
            border-bottom: 3px solid #4a90e2;
            padding: 2rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(74, 144, 226, 0.1), rgba(74, 144, 226, 0.05));
            z-index: 1;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            font-size: 2.8rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
        }

        .header .subtitle {
            font-size: 1.2rem;
            font-weight: 600;
            color: #a0aec0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .main-container {
            flex: 1;
            display: flex;
            max-width: 1600px;
            margin: 0 auto;
            gap: 2rem;
            padding: 2rem;
            width: 100%;
        }

        .sidebar {
            width: 380px;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border: 2px solid #4a90e2;
            border-radius: 8px;
            padding: 2rem;
            height: fit-content;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .sidebar h3 {
            color: #ffffff;
            margin-bottom: 2rem;
            font-size: 1.4rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 1rem;
            border-bottom: 2px solid #4a90e2;
            padding-bottom: 1rem;
        }

        .service-item {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border: 2px solid transparent;
            border-radius: 8px;
            margin-bottom: 1rem;
            color: white;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .service-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(74, 144, 226, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .service-item:hover::before {
            left: 100%;
        }

        .service-item:hover {
            border-color: #4a90e2;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(74, 144, 226, 0.3);
        }

        .service-item i {
            font-size: 1.5rem;
            width: 25px;
            text-align: center;
            color: #4a90e2;
        }

        .service-item strong {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .service-item .service-desc {
            font-size: 0.9rem;
            color: #a0aec0;
            font-weight: 500;
        }

        .faiss-info {
            margin-top: 2rem;
            padding: 2rem;
            background: linear-gradient(135deg, #1a365d 0%, #2a69ac 100%);
            border: 2px solid #4a90e2;
            border-radius: 8px;
            position: relative;
        }

        .faiss-info h4 {
            color: #ffffff;
            margin-bottom: 1rem;
            font-weight: 800;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .faiss-info p {
            font-size: 0.95rem;
            color: #e2e8f0;
            line-height: 1.6;
            font-weight: 500;
        }

        .chat-container {
            flex: 1;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border: 2px solid #4a90e2;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            color: white;
            padding: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #4a90e2;
        }

        .chat-header h2 {
            font-size: 1.8rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-weight: 700;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-dot {
            width: 16px;
            height: 16px;
            background: #48bb78;
            border-radius: 50%;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px rgba(72, 187, 120, 0.5);
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }

        .chat-messages {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            max-height: 600px;
            background: linear-gradient(135deg, #0a0e1a 0%, #1a202c 100%);
        }

        .message {
            margin-bottom: 2rem;
            display: flex;
            gap: 1.5rem;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 0.9rem;
            flex-shrink: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            border: 2px solid #4a90e2;
        }

        .message.assistant .message-avatar {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            border: 2px solid #e53e3e;
        }

        .message-content {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            padding: 1.5rem 2rem;
            border-radius: 8px;
            max-width: 75%;
            border: 1px solid #4a90e2;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            line-height: 1.6;
            font-weight: 500;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            color: white;
            border-color: #4a90e2;
        }

        .chat-input-container {
            padding: 2rem;
            border-top: 2px solid #4a90e2;
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 1.2rem 1.5rem;
            border: 2px solid #4a90e2;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
            background: #1a202c;
            color: white;
            font-weight: 500;
        }

        .chat-input:focus {
            border-color: #63b3ed;
            box-shadow: 0 0 20px rgba(74, 144, 226, 0.3);
        }

        .chat-input::placeholder {
            color: #a0aec0;
        }

        .send-button, .clear-button {
            border: none;
            padding: 1.2rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .send-button {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            border: 2px solid #48bb78;
        }

        .send-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(72, 187, 120, 0.3);
        }

        .clear-button {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
            border: 2px solid #e53e3e;
        }

        .clear-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(229, 62, 62, 0.3);
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 1rem;
            color: #a0aec0;
            font-style: italic;
            padding: 1rem 0;
            font-weight: 600;
        }

        .typing-dots {
            display: flex;
            gap: 6px;
        }

        .typing-dot {
            width: 10px;
            height: 10px;
            background: #4a90e2;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { opacity: 0.3; }
            40% { opacity: 1; }
        }

        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
                padding: 1rem;
            }
            
            .sidebar {
                width: 100%;
                order: 2;
            }
            
            .header {
                padding: 1.5rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }

            .chat-messages {
                max-height: 400px;
            }
        }

        /* Professional scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: #1a202c;
            border-radius: 8px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            border-radius: 8px;
            border: 2px solid #1a202c;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #63b3ed 0%, #4a90e2 100%);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>
                <i class="fas fa-microchip"></i>
                MCP AGENT
            </h1>
            <div class="subtitle">Enterprise Multi-Server Context Protocol Platform</div>
        </div>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <h3><i class="fas fa-server"></i> System Services</h3>
            
            <div class="service-item math">
                <i class="fas fa-calculator"></i>
                <div>
                    <strong>Mathematical Engine</strong>
                    <div class="service-desc">Advanced computational analysis</div>
                </div>
            </div>

            <div class="service-item weather">
                <i class="fas fa-satellite"></i>
                <div>
                    <strong>Weather Intelligence</strong>
                    <div class="service-desc">Real-time meteorological data</div>
                </div>
            </div>

            <div class="service-item translate">
                <i class="fas fa-globe"></i>
                <div>
                    <strong>Translation Matrix</strong>
                    <div class="service-desc">Multi-language processing</div>
                </div>
            </div>

            <div class="service-item websearch">
                <i class="fas fa-search"></i>
                <div>
                    <strong>Web Intelligence</strong>
                    <div class="service-desc">Internet data aggregation</div>
                </div>
            </div>

            <div class="service-item gmail">
                <i class="fas fa-envelope-open"></i>
                <div>
                    <strong>Email Gateway</strong>
                    <div class="service-desc">Communication management</div>
                </div>
            </div>

            <div class="faiss-info">
                <h4>
                    <i class="fas fa-brain"></i> FAISS NEURAL MEMORY
                </h4>
                <p>
                    Enterprise-grade vector similarity search engine providing contextual conversation memory with advanced semantic understanding and retrieval capabilities.
                </p>
            </div>
        </aside>

        <main class="chat-container">
            <div class="chat-header">
                <h2><i class="fas fa-terminal"></i> Command Interface</h2>
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span>SYSTEM ONLINE</span>
                </div>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message assistant">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        <strong>MCP AGENT INITIALIZED</strong><br><br>
                        Enterprise Multi-Server Context Protocol system ready for deployment. All services are operational and standing by for your requests. The system supports mathematical computations, weather intelligence, translation services, web data mining, and email management through advanced AI processing.
                    </div>
                </div>
            </div>

            <div class="typing-indicator" id="typingIndicator">
                <div class="message-avatar" style="background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);">AI</div>
                <span>PROCESSING REQUEST</span>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>

            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Enter command or natural language query..." />
                    <button class="clear-button" onclick="clearChat()">
                        <i class="fas fa-trash-alt"></i> RESET
                    </button>
                    <button class="send-button" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i> EXECUTE
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script>
let conversationHistory = [];
const API_BASE_URL = 'http://localhost:8000';

// Professional response templates
const professionalResponses = [
    "Request processed successfully. Analysis complete:",
    "System has evaluated your query. Results available:",
    "Data processing complete. Here are the findings:",
    "Query executed successfully. Response generated:",
    "Information retrieval complete. Output ready:",
    "Command processed. System response:",
];

function addMessage(content, isUser = false) {
    const messagesContainer = document.getElementById('chatMessages');
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${isUser ? 'user' : 'assistant'}`;
    
    messageDiv.innerHTML = `
        <div class="message-avatar">${isUser ? 'USER' : 'AI'}</div>
        <div class="message-content">${content}</div>
    `;
    
    messagesContainer.appendChild(messageDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
    
    conversationHistory.push({
        role: isUser ? 'user' : 'assistant',
        content: content
    });
}

function showTypingIndicator() {
    document.getElementById('typingIndicator').style.display = 'flex';
    document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
}

function hideTypingIndicator() {
    document.getElementById('typingIndicator').style.display = 'none';
}

// Generate professional response for demo
function generateProfessionalResponse(message) {
    let response;
    const randomIntro = professionalResponses[Math.floor(Math.random() * professionalResponses.length)];
    
    if (message.toLowerCase().includes('weather')) {
        response = `${randomIntro}<br><br><strong>WEATHER INTELLIGENCE REPORT</strong><br>Location: Delhi, India<br>Current Temperature: 35°C<br>Humidity Level: 60%<br>Forecast: Precipitation expected within 24 hours<br>System Recommendation: Carry protective gear for weather conditions.`;
    } else if (message.toLowerCase().includes('calculate') || message.includes('*') || message.includes('+') || message.includes('-')) {
        response = `${randomIntro}<br><br><strong>MATHEMATICAL ENGINE OUTPUT</strong><br>Calculation processed through advanced computational algorithms. All mathematical operations have been executed with precision. Result verified through multiple validation protocols.`;
    } else if (message.toLowerCase().includes('translate')) {
        response = `${randomIntro}<br><br><strong>TRANSLATION MATRIX ACTIVATED</strong><br>Multi-language processing engine engaged. System supports comprehensive translation services across multiple linguistic frameworks with semantic accuracy preservation.`;
    } else if (message.toLowerCase().includes('email') || message.toLowerCase().includes('gmail')) {
        response = `${randomIntro}<br><br><strong>EMAIL GATEWAY STATUS</strong><br>Communication protocol established. Message queued for transmission through secure channels. Email management system operational and ready for deployment.`;
    } else if (message.toLowerCase().includes('search')) {
        response = `${randomIntro}<br><br><strong>WEB INTELLIGENCE SCAN</strong><br>Internet data aggregation complete. Information retrieved from multiple authoritative sources. Data analysis and processing through advanced algorithms completed successfully.`;
    } else {
        response = `${randomIntro}<br><br><strong>SYSTEM ANALYSIS</strong><br>Request processed through FAISS neural memory system. Vector similarity search engaged for contextual understanding. Advanced semantic processing applied for optimal response generation.`;
    }
    return response;
}

async function sendMessage() {
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    // Add user message
    addMessage(message, true);
    input.value = '';
    
    // Show typing indicator
    showTypingIndicator();
    
    try {
        // Send message to FastAPI client.py backend
        const response = await fetch(`${API_BASE_URL}/chat`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json',
            },
            body: JSON.stringify({
                message: message,
                conversation_id: 'web_session_' + Date.now()
            })
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        hideTypingIndicator();
        
        // Add AI response from API
        if (data.response) {
            addMessage(data.response);
        } else if (data.error) {
            addMessage(`<strong>SYSTEM ERROR</strong><br>Error: ${data.error}`, false);
        } else {
            addMessage(`<strong>SYSTEM ERROR</strong><br>Unexpected response format`, false);
        }
        
    } catch (error) {
        // Fallback to demo mode if API is not available
        console.log('FastAPI client not available, using enterprise demo mode:', error);
        
        // Simulate API delay for demo
        setTimeout(() => {
            hideTypingIndicator();
            const professionalResponse = generateProfessionalResponse(message);
            addMessage(professionalResponse);
        }, 2000);
    }
}

async function clearChat() {
    try {
        // Try to clear chat via FastAPI client
        const response = await fetch(`${API_BASE_URL}/clear`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json',
            },
            body: JSON.stringify({
                conversation_id: 'web_session_' + Date.now()
            })
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        // Clear frontend messages
        const messagesContainer = document.getElementById('chatMessages');
        messagesContainer.innerHTML = `
            <div class="message assistant">
                <div class="message-avatar">AI</div>
                <div class="message-content">
                    <strong>SYSTEM RESET COMPLETE</strong><br><br>
                    ${data.message || 'All conversation data cleared. FAISS neural memory database reinitialized. System ready for new session deployment.'}
                </div>
            </div>
        `;
        conversationHistory = [];
        
    } catch (error) {
        // Fallback to local clear if API is not available
        console.log('FastAPI client not available for clear, clearing locally:', error);
        
        const messagesContainer = document.getElementById('chatMessages');
        messagesContainer.innerHTML = `
            <div class="message assistant">
                <div class="message-avatar">AI</div>
                <div class="message-content">
                    <strong>SYSTEM RESET COMPLETE</strong><br><br>
                    All conversation data cleared. FAISS neural memory database reinitialized. System ready for new session deployment.
                </div>
            </div>
        `;
        conversationHistory = [];
    }
}

// Check server health on page load
async function checkServerHealth() {
    try {
        const response = await fetch(`${API_BASE_URL}/health`, {
            method: 'GET',
            headers: {
                'Accept': 'application/json',
            }
        });
        
        if (response.ok) {
            const data = await response.json();
            console.log('FastAPI client health:', data);
            
            // Update status indicator
            const statusDot = document.querySelector('.status-dot');
            const statusText = document.querySelector('.status-indicator span');
            
            if (data.status === 'healthy' || data.mcp_servers_connected || data.servers_status) {
                statusDot.style.background = '#48bb78';
                statusText.textContent = 'SYSTEM ONLINE';
            } else {
                statusDot.style.background = '#ed8936';
                statusText.textContent = 'INITIALIZING';
            }
        }
    } catch (error) {
        console.log('FastAPI client health check failed, demo mode available:', error);
        const statusDot = document.querySelector('.status-dot');
        const statusText = document.querySelector('.status-indicator span');
        statusDot.style.background = '#e53e3e';
        statusText.textContent = 'DEMO MODE';
    }
}

// Enter key support
document.getElementById('chatInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        sendMessage();
    }
});

// Service item click functionality with professional responses
document.querySelectorAll('.service-item').forEach(item => {
    item.addEventListener('click', function() {
        const serviceName = this.querySelector('strong').textContent;
        let testMessage;
        
        switch(serviceName) {
            case 'Mathematical Engine':
                testMessage = 'Calculate complex equation: 25 * 4 + 10^2';
                break;
            case 'Weather Intelligence':
                testMessage = 'Provide weather analysis for Delhi, India';
                break;
            case 'Translation Matrix':
                testMessage = 'Translate "Advanced AI system" to multiple languages';
                break;
            case 'Web Intelligence':
                testMessage = 'Search for latest artificial intelligence developments';
                break;
            case 'Email Gateway':
                testMessage = 'Initialize email communication protocol';
                break;
            default:
                testMessage = `System diagnostic for ${serviceName}`;
        }
        
        document.getElementById('chatInput').value = testMessage;
        
        // Also add a demo service explanation when clicked
        addMessage(`System diagnostic request: ${serviceName}`, true);
        
        setTimeout(() => {
            let serviceResponse;
            switch(serviceName) {
                case 'Mathematical Engine':
                    serviceResponse = "<strong>MATHEMATICAL ENGINE STATUS</strong><br><br>Advanced computational system operational. Supports complex algebraic operations, statistical analysis, and mathematical modeling. High-precision calculations with multi-variable support enabled.";
                    break;
                case 'Weather Intelligence':
                    serviceResponse = "<strong>WEATHER INTELLIGENCE STATUS</strong><br><br>Real-time meteorological data acquisition active. Satellite integration established. Provides comprehensive weather analysis including temperature, humidity, precipitation forecasts, and atmospheric pressure readings.";
                    break;
                case 'Translation Matrix':
                    serviceResponse = "<strong>TRANSLATION MATRIX STATUS</strong><br><br>Multi-language processing engine online. Supports 50+ languages with semantic preservation algorithms. Advanced natural language understanding with context-aware translation capabilities.";
                    break;
                case 'Web Intelligence':
                    serviceResponse = "<strong>WEB INTELLIGENCE STATUS</strong><br><br>Internet data mining protocols active. Real-time information retrieval from authoritative sources. Advanced filtering and analysis algorithms provide relevant, current information with source verification.";
                    break;
                case 'Email Gateway':
                    serviceResponse = "<strong>EMAIL GATEWAY STATUS</strong><br><br>Secure communication protocols established. SMTP/IMAP integration operational. Supports automated email management, scheduling, and intelligent message processing with encryption standards.";
                    break;
            }
            addMessage(serviceResponse);
        }, 1500);
    });
});

// Check server health on page load
window.addEventListener('load', checkServerHealth);
    </script>
</body>
</html>